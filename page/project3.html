<!DOCTYPE html>
<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Wen-Hao Chung - Project III</title>
    <!--[if lt IE 9]>
        <script src="http://css3-mediaqueries-js.googlecode.com/svn/trunk/css3-mediaqueries.js"></script>
        <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/2.3.2/css/bootstrap.min.css">
    <link href="../css/bootstrap.min.css" rel="stylesheet">
    <link href="../css/bootstrap-responsive.min.css" rel="stylesheet">
    <link href="../css/styles.css" rel="stylesheet">
    <link href="../css/media-queries.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css?family=Exo:400,800" rel="stylesheet">
    <meta name="viewport" content="width=device-width">
</head>
<body data-spy="scroll">
    <!-- 相同的導航列，僅修改 active 狀態 -->


        <!-- ✅ 這裡放導航列 -->
        <div class="navbar navbar-fixed-top">
            <div class="navbar-inner">
                <div class="container">
                    <!-- 手機選單按鈕 -->
                    <a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                    </a>
    
                    <!-- 網站品牌 -->
                    <a class="brand" >Ivan's Portfolio</a>
    
                    <!-- 導航列內容 -->
                    <div class="nav-collapse collapse">
                        <ul class="nav pull-right">
                            <li><a href="../index.html">Home</a></li>
                            <li><a href="resume.html">Resume</a></li>
                            <li><a href="project1.html">Project I</a></li>
                            <li><a href="project2.html">Project II</a></li>
                            <li class="active"><a href="project3.html">Project III</a></li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>

    <!-- Resume Content -->

<!-- Main Content -->
<div class="container content" id="home">
    <!-- Portfolio 3 Section -->
    <div class="row-fluid" id="portfolio3"style="text-align: justify;">
        <h2 class="page-title">Project III - Principal Component Analysis</h2>
        
        <div class="span12">
            <h3>SQL-R Integrated Workflow for Dimensionality Reduction and Pattern Discovery in NY Demographic Data</h3>
            <div class="project-details">

                <h4>Objective</h4>
                <p> The project aims to perform <strong>dimensionality reduction</strong> using <strong>Principal Component Analysis</strong> (PCA) on a dataset containing demographic and economic attributes. Since high-dimensional data (10 dimensions) cannot be directly visualized, the analysis focuses on 2D projections to identify underlying patterns.</p>
                <p>The workflow involves <strong>SQL</strong> for data preparation and <strong>R</strong> for statistical analysis and visualization.</p>
                <ul>
                    <li>SQL efficiently handles large datasets, ensures data integrity, and performs filtering/aggregation.</li>
                    <li>R leverages statistical libraries (e.g., eigenvalue computation, pairs()) and visualization tools to uncover patterns that SQL alone cannot reveal.</li>

                    <li>This end-to-end process transforms raw data into actionable insights, demonstrating the synergy between SQL for data engineering and R for advanced analytics.</li>
                </ul>               
                
                <h4>Table Overview</h4>
                <p><strong>Orders Table:</strong> </p>
                <p> &nbsp;&nbsp; This table stores customer order information, including order ID, customer and campaign IDs, date, location (city, <strong>state</strong>, ZIP code), payment method, total price, and quantities. It supports sales and geographic trend analysis.</p>

                <p><strong>Census Table:</strong> </p>
                <p> &nbsp;&nbsp; This table contains rich census data by ZIP code, including details on population, household income, employment, education, and housing. It is useful for demographic and socioeconomic analysis. <strong>Key Categories & Fields:</strong></p>
                <ul>
                    <li><strong>Population Demographics: </strong> e.g., Age, Gender, etc.</li>
                    <li><strong>Race & Ethnicity: </strong> e.g., Asian, Indian, White, etc.</li>
                    <li><strong>Household & Family Data: </strong> e.g., Household Types, Income Brackets, Household Composition, etc.</li>
                    <li><strong>Income & Poverty: </strong> e.g., Income Metrics, Poverty Status, etc.</li>
                    <li><strong>Employment & Workforce: </strong> e.g., Labor Force, Commuting, etc.</li>
                    <li><strong>Housing: </strong> e.g., Occupancy & Structure, Costs & Utilities, etc.</li>
                    <li><strong>Education & Language: </strong> e.g., School Enrollment, Educational Attainment, Language, etc.</li>
                    <li><strong>Health & Insurance: </strong> e.g., Insurance Coverage, Disability Status, etc.</li>
                    <li><strong>Migration & Birthplace: </strong> e.g., Residential Mobility, Birthplace, etc.</li>
                    <li><strong>Technology Access: </strong> e.g., Household Tech, etc.</li>
                </ul> 
                <p><strong>Key Use Cases:</strong> </p>
                <ul>
                    <li><strong>Market research: </strong> e.g., income brackets, household types, etc.</li>
                    <li><strong>Public health: </strong> e.g., poverty rates, insurance coverage, etc.</li>

                    <li><strong>Urban planning: </strong> e.g., commuting patterns, housing stock, etc.</li>
                </ul> 

                

                
                <h4>Technical Highlights</h4>
                <div class="row-fluid">
                    <div class="span6">
                        <h5>Key Techniques</h5>
                        <ul>
                            
                            <li><strong>SQL</strong> Random Sampling Methods</li>
                            <li>Common Table Expression (CTE)</li>
                            <li>Window Function</li>
                            <li>ODBC Connection (RODBC <strong>R</strong> Package)</li>
                            <li>Exploratory Data Analysis (EDA)</li>
                            <li>Principal Component Analysis (PCA)</li>
                            
                        </ul>
                    </div>
                    <div class="span6">
                        
                    </div>
                </div>

                
                <h4>SQL Data Preparation</h4>

<!-- Figure 8 -->

<div class="figure-container">
    <img src="../static/NY.png" alt="Figure 1: Correlation between all variables"style="width: 10%;">
    <p><strong>Figure 1.</strong> Ranking High-Order States</p>
    <img src="../static/feature33.png" alt="Figure 2: Correlation between Y and predictors"style="width: 50%;">
    <p><strong>Figure 2.</strong> Selected Features</p>
</div>

<!-- Explanation -->
<div class="explanation">
    <p>SQL is used for data extraction, cleaning, and preprocessing, tasks efficiently handled by relational databases. This ensures data quality and relevance before statistical analysis in R. <strong>Steps:</strong></p>
        <ul>
            <li><p><strong>Identify High-Order States: </strong>A query calculates the total number of orders per state using a <strong>Common Table Expression</strong> (CTE) for better structure and readability. The CTE (StateOrders) groups order data by state and counts the total number of orders for each. From this result, <strong>New York</strong> (NY) is selected as the focus due to having the highest order count, ensuring a representative dataset for analysis.</p>
            <li><p><strong>Select Relevant Columns: </strong>Ten numerical columns from the <strong>ZipCensus</strong> table are chosen, capturing diverse attributes (e.g., population, income, education). These columns avoid redundancies (e.g., totals vs. breakdowns) to ensure independent variables for PCA.</p>
            <li><p><strong>Filter and Join Data: </strong>Data is filtered to include only NY state records by joining the <strong>Orders</strong> and <strong>ZipCensus</strong> tables on ZIP codes. This ensures geographical consistency.</p>
            <li><p><strong>Random Sampling: </strong>A 2% random sample is extracted using <strong>ORDER BY NEWID()</strong>. Sampling reduces computational load while preserving data distribution for exploratory analysis.</p>
        </ul>
</div>

<h4>Four SQL Random Sampling Methods</h4>

<div class="figure-container">

</div>

<!-- Explanation -->
<div class="explanation">
    <p><strong>Method 1</strong>: Random Shuffling with <strong>NEWID()</strong></p>
    <ul>
        <li><p><strong>Description: </strong>Randomizes the entire dataset using <strong>ORDER BY NEWID()</strong>, then selects the top N% of records.</p>
        <li><p><strong>Use Case: </strong>Ideal for simple, unbiased random sampling where no stratification or grouping is required.</p>
        <li><p><strong>Strengths: </strong>Guarantees equal probability of selection for all records.</p>
        <li><p><strong>Weaknesses: </strong>Performance-intensive for large datasets due to full-table sorting.</p>
    </ul>
    <p><strong>Method 2</strong>: Pseudo Random Sampling with Prime Numbers</p>
    <ul>
        <li><p><strong>Description: </strong>Assigns sequential row numbers, applies a mathematical formula (e.g., (<strong>RowNumber * 71 + 199) % 100 < 10</strong>), and selects rows based on the result.</p>
        <li><p><strong>Use Case: </strong>Efficient for large datasets where <strong>NEWID()</strong> is too slow.</p>
        <li><p><strong>Strengths: </strong>Avoids sorting overhead, improving performance.</p>
        <li><p><strong>Weaknesses: </strong>Pseudorandomness depends on prime number selection; patterns may emerge, compromising true randomness.</p>
    </ul>
    <p><strong>Method 3</strong>: Stratified Sampling by Category</p>
    <ul>
        <li><p><strong>Description: </strong>Uses a <strong>Window Function</strong> to generate row numbers partitioned by a categorical variable (e.g., <strong>IsActive</strong>), then selects records at fixed intervals (e.g., every 100th row).</p>
        <li><p><strong>Use Case: </strong>Maintains the original proportion of categories (e.g., 1:0 ratio) in the sample.</p>
        <li><p><strong>Strengths: </strong>Preserves distribution of categorical variables.</p>
        <li><p><strong>Weaknesses: </strong>Fails if category sizes are too small (e.g., rare categories may not appear in the sample).</p>
    </ul>
    <p><strong>Method 4</strong>: Balanced Group Sampling</p>
    <ul>
        <li><p><strong>Description: </strong>Partitions data by a skewed variable (e.g., gender), shuffles within each group using <strong>NEWID()</strong>, and selects an equal number of samples per group.</p>
        <li><p><strong>Use Case: </strong>Ensures balanced representation of underrepresented groups (e.g., equal male/female samples).</p>
        <li><p><strong>Strengths: </strong>Mitigates bias from imbalanced groups.</p>
        <li><p><strong>Weaknesses: </strong>Requires explicit grouping variables and may fail if groups have extremely low counts.</p>
    </ul>
    <p><strong>Which Method 1 Is Used? </strong>: Method 1 is chosen for its simplicity, true randomness, and suitability for exploratory analysis where no specific stratification is required.</p>
</div>

<h4>R Statistical Analysis</h4>

<div class="figure-container">
    <img src="../static/10D.png" alt="Figure 8: Correlation between Y and predictors"style="width: 50%;">
    <p><strong>Figure 3.</strong> Scatter Plots for All Variable Pairs</p>
    <img src="../static/pcavar.png" alt="Figure 8: Correlation between Y and predictors"style="width: 30%;">
    <p><strong>Figure 4.</strong> Covariance Matrix and Eigen Analysis</p>
</div>

<!-- Explanation -->
<div class="explanation">
    <p>R specializes in statistical modeling and visualization. It processes the preprocessed SQL data to perform PCA, compute eigenvalues/vectors, and generate plots.</p>
    <ul>
        <li><p><strong>Database Connection: </strong>The <strong>RODBC</strong> package connects R to the SQL database, retrieving the preprocessed 2% sample for analysis.</p>
        <li><p><strong>Initial Visualization: </strong>The <strong>pairs()</strong> function generates scatter plots for all variable pairs, providing a preliminary view of correlations and distributions in the 10D dataset.</p>
        
    </ul>
    <p>Covariance Matrix & Eigen Analysis.</p>
    <ul>
        
        <li><p>Eigenvalues (<strong>lambda</strong>) and eigenvectors (U) are derived using <strong>eigen()</strong>, representing variance magnitude and principal directions, respectively.</p>
        <li><p>A scree plot (<strong>plot(lambda, type='o')</strong>) visualizes eigenvalues, showing variance explained by each principal component (PC). The <strong>First Two</strong> PCs capture <strong>most variance</strong>, while others represent noise</p>
    </ul>
</div>

<h4>Projection onto Principal Components</h4>

<div class="figure-container">
    <img src="../static/PCA.png" alt="Figure 8: Correlation between Y and predictors"style="width: 50%;">
    <p><strong>Figure 5.</strong> 2D projection</p>
</div>

<!-- Explanation -->
<div class="explanation">
    
    <ul>
        <li><p>The first two eigenvectors (U[,1] and U[,2]) transform the centered data into 2D coordinates (<strong>f1, f2</strong>).</p>
        <li><p>A scatter plot (plot(f1, f2)) visualizes the 2D projection. The <strong>triangular cluster</strong> structure emerges, indicating underlying patterns in the reduced dimensions.</p>
    </ul>
    <p>Visualization & Interpretation</p>
    <ul>
        <li><p>Eigenvalue Plot confirms the dominance of the first two PCs, justifying dimensionality reduction.</p>
        <li><p>2D Projection Plot reveals clustered data points forming a triangle, suggesting distinct subgroups within the NY demographic dataset.</p>
        <li><p>By projecting into PCA space, we're uncovering <strong>latent dimensions</strong> in the demographic data.</p>
    </ul>
    <p>The clusters in 2D space may correspond to real-world groupings, such as:</p>
    <ul>
        <li><p>ZIP codes with predominantly young professionals.</p>
        <li><p>Areas with high poverty and low education.</p>
        <li><p>High-income neighborhoods with strong transit access.</p>
    </ul>
    <p>These insights are not obvious when looking at the raw dataset, but <strong>PCA</strong> helps reveal them.</p>
</div>

            </div>
        </div>
    </div>
    
</div>


    <!-- Footer -->
    <div class="footer container">
        <div id="copyright">
            &copy; 2025 Wen-Hao Chung. All rights reserved.
        </div>
    </div>

    <!-- Scripts -->
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/2.3.2/js/bootstrap.min.js"></script>
    
    <script>
        document.addEventListener("DOMContentLoaded", function () {
          // 先清掉所有 active
          document.querySelectorAll(".nav li").forEach(li => li.classList.remove("active"));
      
          // 找到目前網址的檔名（如 resume.html）
          const currentPage = window.location.pathname.split("/").pop();
      
          // 根據 href 配對加上 active
          document.querySelectorAll(".nav li a").forEach(link => {
            if (link.getAttribute("href") === currentPage) {
              link.parentElement.classList.add("active");
            }
          });
        });
    </script>
    <script>
        document.addEventListener('click', function (event) {
            var toggle = document.querySelector('.navbar .btn-navbar');
            var menu = document.querySelector('.navbar .nav-collapse');
        
            // 如果選單是展開的，並且點擊的不是選單或按鈕本身
            if (menu.classList.contains('in') && !menu.contains(event.target) && !toggle.contains(event.target)) {
                // 觸發收合
                toggle.click();
            }
        });
    </script>
</body>
</html>